
package processor.m500_memory;

import processor.m500_memory.RAM;

component RAM8 {

    RAM ram0; // 0 1
    RAM ram1;
    RAM ram2;
    RAM ram3;
    port in boolean ad7, ad6, ad5, ad4, ad3, ad2, ad1, ad0;
    port in boolean st, cl;
    port in boolean x7,x6,x5,x4,x3,x2,x1,x0;
    port out boolean a7,a6,a5,a4,a3,a2,a1,a0;



    compute {
        int v7 = ad7 ? 1 : 0;
        int v6 = ad6 ? 1 : 0;
        int v5 = ad5 ? 1 : 0;
        int v4 = ad4 ? 1 : 0;
        int v3 = ad3 ? 1 : 0;
        int v2 = ad2 ? 1 : 0;
        int v1 = ad1 ? 1 : 0;
        int v0 = ad0 ? 1 : 0;
        int full_addr = (v7 * 128 + v6 * 64 + v5 * 32 + v4 * 16 + v3 * 8 + v2 * 4 + v1 * 2 + v0);
        int addr = full_addr % 8; // 0-7  3
        int ram_num = addr / 2; 
        int ram_add_num = (1 - addr %2);
        if(ram_num == 0){
            ram0.ad = ram_add_num ? true : false;
            ram0.st = st;
            ram0.cl = cl;
            ram0.x7 = x7;
            ram0.x6 = x6;
            ram0.x5 = x5;
            ram0.x4 = x4;
            ram0.x3 = x3;
            ram0.x2 = x2;
            ram0.x1 = x1;
            ram0.x0 = x0;
            a7 = ram0.a7;
            a6 = ram0.a6;
            a5 = ram0.a5;
            a4 = ram0.a4;
            a3 = ram0.a3;
            a2 = ram0.a2;
            a1 = ram0.a1;
            a0 = ram0.a0;
        }else if( ram_num == 1){
            ram1.ad = ram_add_num ? true : false;
            ram1.st = st;
            ram1.cl = cl;
            ram1.x7 = x7;
            ram1.x6 = x6;
            ram1.x5 = x5;
            ram1.x4 = x4;
            ram1.x3 = x3;
            ram1.x2 = x2;
            ram1.x1 = x1;
            ram1.x0 = x0;
            a7 = ram1.a7;
            a6 = ram1.a6;
            a5 = ram1.a5;
            a4 = ram1.a4;
            a3 = ram1.a3;
            a2 = ram1.a2;
            a1 = ram1.a1;
            a0 = ram1.a0;
        }else if( ram_num == 2){
            ram2.ad = ram_add_num ? true : false;
            ram2.st = st;
            ram2.cl = cl;
            ram2.x7 = x7;
            ram2.x6 = x6;
            ram2.x5 = x5;
            ram2.x4 = x4;
            ram2.x3 = x3;
            ram2.x2 = x2;
            ram2.x1 = x1;
            ram2.x0 = x0;
            a7 = ram2.a7;
            a6 = ram2.a6;
            a5 = ram2.a5;
            a4 = ram2.a4;
            a3 = ram2.a3;
            a2 = ram2.a2;
            a1 = ram2.a1;
            a0 = ram2.a0;
        }else if( ram_num == 3){
            ram3.ad = ram_add_num ? true : false;
            ram3.st = st;
            ram3.cl = cl;
            ram3.x7 = x7;
            ram3.x6 = x6;
            ram3.x5 = x5;
            ram3.x4 = x4;
            ram3.x3 = x3;
            ram3.x2 = x2;
            ram3.x1 = x1;
            ram3.x0 = x0;
            a7 = ram3.a7;
            a6 = ram3.a6;
            a5 = ram3.a5;
            a4 = ram3.a4;
            a3 = ram3.a3;
            a2 = ram3.a2;
            a1 = ram3.a1;
            a0 = ram3.a0;          
        }
    }
}